{% extends 'base.html' %}
{% load static %}

{% block title %}Blog | czystepanele.pl{% endblock %}

{% block meta %}
  <meta name="description" content="Porady, inspiracje i wskazówki dotyczące czyszczenia paneli, podłóg, okien i pielęgnacji wnętrz.">
{% endblock %}

{% block content %}
<section class="pt-36 sm:pt-40 pb-20 sm:pb-24 lg:pb-32 px-4 sm:px-10 lg:px-16 bg-gray-50">
  <div class="max-w-7xl mx-auto">

    <!-- NAGŁÓWEK -->
    <h1 class="text-4xl sm:text-5xl font-bold text-[#000042] text-center mb-12">
      Blog
    </h1>

    <!-- FILTRY KATEGORII -->
    <div class="flex flex-wrap justify-center gap-3 mb-12">
      <button class="category-filter active bg-gray-900 text-white px-5 py-2 rounded-full hover:bg-gray-800 transition"
              data-cat="all">Wszystkie</button>

      {% for cat in categories %}
        <button class="category-filter bg-gray-200 text-gray-800 px-5 py-2 rounded-full hover:bg-gray-300 transition"
                data-cat="{{ cat.id }}">{{ cat.name }}</button>
      {% endfor %}
    </div>

    <!-- GRID WPISÓW -->
    <div id="blog-grid" class="grid gap-10 sm:grid-cols-2 lg:grid-cols-3">

      {% for post in posts %}
        <article 
          class="blog-card bg-white shadow-md hover:shadow-xl rounded-xl overflow-hidden transition-all duration-300"
          data-cat="{{ post.category.id }}">

          <!-- Thumbnail -->
          <a href="{{ post.get_absolute_url }}">
            {% if post.thumbnail %}
              <img src="{{ post.thumbnail.url }}" 
                   alt="{{ post.title }}" 
                   class="w-full h-56 object-cover" loading="lazy">
            {% else %}
              <div class="w-full h-56 bg-gray-200 flex items-center justify-center text-gray-600">Brak zdjęcia</div>
            {% endif %}
          </a>

          <div class="p-6">

            <!-- Kategoria + Data -->
            <div class="flex items-center justify-between mb-3 text-sm text-gray-500">
              {% if post.category %}
                <span class="bg-gray-100 text-gray-700 px-3 py-1 rounded-full text-xs font-medium">
                  {{ post.category.name }}
                </span>
              {% endif %}
              <span>{{ post.published|date:"d.m.Y" }}</span>
            </div>

            <!-- Tytuł -->
            <a href="{{ post.get_absolute_url }}">
              <h2 class="text-xl font-bold text-gray-900 mb-2 hover:text-[#000042] transition">
                {{ post.title }}
              </h2>
            </a>

            <!-- Intro -->
            <p class="text-gray-600 mb-4 line-clamp-3">
              {{ post.intro|truncatewords:25 }}
            </p>

            <!-- Tagi -->
            {% if post.tags.all %}
            <div class="flex flex-wrap gap-2 mb-4">
              {% for tag in post.tags.all %}
                <span class="text-xs bg-blue-50 text-blue-700 px-2 py-1 rounded-md">
                  #{{ tag }}
                </span>
              {% endfor %}
            </div>
            {% endif %}

            <!-- CTA -->
            <a href="{{ post.get_absolute_url }}" 
               class="inline-block text-[#000042] font-semibold hover:underline">
              Czytaj więcej →
            </a>

          </div>
        </article>
      {% endfor %}

    </div>

  </div>
</section>

<!-- FILTROWANIE KATEGORII -->
<script>
  document.querySelectorAll(".category-filter").forEach(btn => {
    btn.addEventListener("click", () => {

      // zmiana aktywnego
      document.querySelectorAll(".category-filter").forEach(b => 
        b.classList.remove("active", "bg-gray-900", "text-white")
      );
      btn.classList.add("active", "bg-gray-900", "text-white");

      const selected = btn.dataset.cat;

      document.querySelectorAll(".blog-card").forEach(card => {
        const cardCat = card.dataset.cat;
        card.classList.toggle("hidden", !(selected === "all" || selected === cardCat));
      });

    });
  });
</script>

<style>
  .category-filter.active {
    background-color: #111827 !important;
    color: #fff !important;
  }
</style>
{% endblock %}
